{{define "content"}}
<div class="card" style="padding: 0; overflow: hidden; margin-bottom: 2rem;">
    <div style="height: 200px; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); position: relative;">
        <!-- Abstract pattern in background -->
        <div
            style="position: absolute; inset: 0; opacity: 0.15; background-image: radial-gradient(var(--accent) 1px, transparent 1px); background-size: 24px 24px;">
        </div>
        <!-- Orbiting circles effect -->
        <div
            style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 300px; height: 300px; border: 1px solid rgba(255,255,255,0.05); border-radius: 50%; pointer-events: none;">
        </div>
    </div>
    <div style="padding: 0 2.5rem 2.5rem; margin-top: -70px;">
        <div style="display: flex; justify-content: space-between; align-items: flex-end; gap: 2rem;">
            <div class="avatar-glow"
                style="width: 160px; height: 160px; margin: 0; font-size: 4rem; border: 6px solid var(--bg-card); border-radius: 32px;">
                {{if .Name}}{{slice .Name 0 1}}{{else}}?{{end}}
            </div>
            <div style="margin-bottom: 0.75rem; display: flex; gap: 1rem;">
                {{if .Connected}}
                <div
                    style="display: flex; align-items: center; gap: 0.6rem; color: #10b981; font-weight: 700; font-size: 0.95rem; padding: 0.75rem 1.75rem; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.2); border-radius: 12px; letter-spacing: 0.5px;">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="3" viewBox="0 0 24 24">
                        <path d="M20 6L9 17L4 12"></path>
                    </svg>
                    NETWORK SYNCED
                </div>
                <button class="btn" style="padding: 0.75rem 1.75rem; border-radius: 12px;"
                    onclick="location.href='/messages?id={{.ID}}'">Message</button>
                {{else}}
                <button class="btn connect-btn" id="main-connect-btn"
                    style="padding: 0.75rem 1.75rem; border-radius: 12px; font-weight: 700;">
                    Initialize Request
                </button>
                <button class="btn btn-outline"
                    style="padding: 0.75rem 1.75rem; border-radius: 12px; opacity: 0.6;">More</button>
                {{end}}
            </div>
        </div>
        <div style="margin-top: 2rem;">
            <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                <h1 id="profile-name" style="font-size: 2.2rem; font-weight: 800; letter-spacing: -1px; margin: 0;">
                    {{.Name}}</h1>
                {{if .Connected}}<span title="Verified Network Entity" style="color: var(--accent);"><svg width="24"
                        height="24" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z">
                        </path>
                    </svg></span>{{end}}
            </div>
            <p id="profile-title"
                style="font-size: 1.25rem; color: var(--accent); font-weight: 600; margin: 0.3rem 0; letter-spacing: 0.5px;">
                {{.Title}}</p>
            <p id="profile-company-location"
                style="color: var(--text-dim); font-size: 1.05rem; margin-top: 0.75rem; display: flex; align-items: center; gap: 0.6rem;">
                <span style="font-weight: 700; color: var(--text-white);">{{.Company}}</span>
                <span style="opacity: 0.3;">‚óè</span>
                {{.Location}}
            </p>
            <div
                style="margin-top: 1.5rem; display: flex; gap: 2rem; font-size: 0.9rem; border-top: 1px solid var(--border); padding-top: 1.5rem;">
                <div style="display: flex; flex-direction: column; gap: 0.2rem;">
                    <span style="color: var(--text-white); font-weight: 700; font-size: 1.1rem;">500+</span>
                    <span
                        style="color: var(--text-dim); text-transform: uppercase; font-size: 0.65rem; letter-spacing: 1px;">Network
                        Nodes</span>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.2rem;">
                    <span style="color: var(--text-white); font-weight: 700; font-size: 1.1rem;">124</span>
                    <span
                        style="color: var(--text-dim); text-transform: uppercase; font-size: 0.65rem; letter-spacing: 1px;">Mutual
                        Synergies</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card" style="margin-bottom: 2rem; padding: 2.5rem; position: relative; overflow: hidden;">
    <div
        style="position: absolute; top: 0; right: 0; padding: 1rem; opacity: 0.05; font-size: 4rem; pointer-events: none;">
        üìÑ</div>
    <h3
        style="margin-bottom: 1.5rem; font-size: 1.25rem; font-weight: 700; display: flex; align-items: center; gap: 0.75rem; letter-spacing: -0.25px;">
        <svg width="22" height="22" fill="none" stroke="var(--accent)" stroke-width="2.5" viewBox="0 0 24 24">
            <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
        Intelligence Summary
    </h3>
    <p style="color: var(--text-dim); line-height: 1.8; font-size: 1.1rem; max-width: 800px;">
        High-performing node with specialized capabilities in <span
            style="color: var(--text-white); font-weight: 600;">{{.Title}}</span>. Demonstrates consistent execution
        across distributed environments and excels in mission-critical protocol optimization. Essential for scaling
        network throughput and localized intelligence gathering within <span
            style="color: var(--text-white); font-weight: 600;">{{.Company}}</span>.
    </p>
</div>

<!-- Connection Modal -->
<div id="note-modal"
    style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(20px);">
    <div class="card"
        style="max-width: 550px; width: 95%; padding: 3rem; border-color: var(--accent); box-shadow: 0 0 50px rgba(112,0,255,0.25);">
        <h3
            style="margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.75rem; font-size: 1.5rem; color: var(--text-white); font-weight: 800;">
            <svg width="26" height="26" fill="none" stroke="var(--accent)" stroke-width="2.5" viewBox="0 0 24 24">
                <path d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z">
                </path>
            </svg>
            Personalize Handshake
        </h3>
        <p style="color: var(--text-dim); font-size: 0.95rem; margin-bottom: 2.5rem; line-height: 1.6;">
            Establish a direct link with <strong>{{.Name}}</strong>. A tailored protocol ensures higher acceptance
            rates.
        </p>

        <textarea id="note-text" class="input-field"
            style="width: 100%; height: 180px; line-height: 1.6; resize: none; margin-bottom: 2.5rem; background: var(--bg-deep); border-radius: 16px; padding: 1.5rem;"
            placeholder="System protocol: Requesting secure connection with {{.Name}}..."></textarea>

        <div style="display: flex; justify-content: flex-end; gap: 1.5rem;">
            <button id="cancel-note" class="btn btn-outline" style="min-width: 120px;">Abort</button>
            <button id="send-note" class="btn" style="min-width: 180px; font-weight: 800;">Initiate Dispatch</button>
        </div>
    </div>
</div>

<script>
    const connectBtn = document.getElementById('main-connect-btn');
    const noteModal = document.getElementById('note-modal');
    if (connectBtn) {
        connectBtn.addEventListener('click', () => {
            noteModal.style.display = 'flex';
            document.getElementById('note-text').focus();
        });
    }

    const cancelBtn = document.getElementById('cancel-note');
    if (cancelBtn) {
        cancelBtn.addEventListener('click', () => {
            document.getElementById('note-modal').style.display = 'none';
        });
    }

    const sendBtn = document.getElementById('send-note');
    if (sendBtn) {
        sendBtn.addEventListener('click', () => {
            const profileId = '{{.ID}}';
            sendBtn.innerHTML = '<span class="loading-dots">Dispatching</span>';
            sendBtn.disabled = true;

            fetch('/api/connect?id=' + profileId, { method: 'POST' })
                .then(r => r.text())
                .then(() => {
                    document.getElementById('note-modal').style.display = 'none';
                    setTimeout(() => location.reload(), 600);
                })
                .catch(() => {
                    sendBtn.innerHTML = 'Initiate Dispatch';
                    sendBtn.disabled = false;
                });
        });
    }

    // Modal background close
    noteModal.addEventListener('click', (e) => {
        if (e.target.id === 'note-modal') noteModal.style.display = 'none';
    });
</script>
<style>
    .loading-dots::after {
        content: '.';
        animation: dots 1.5s steps(5, end) infinite;
    }

    @keyframes dots {

        0%,
        20% {
            content: '.';
        }

        40% {
            content: '..';
        }

        60% {
            content: '...';
        }

        80%,
        100% {
            content: '';
        }
    }

    .avatar-glow {
        background: linear-gradient(135deg, #4834d4, #686de0);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 800;
        box-shadow: 0 0 30px rgba(112, 0, 255, 0.4);
    }
</style>
{{end}}